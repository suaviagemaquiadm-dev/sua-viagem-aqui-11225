import"./modulepreload-polyfill-B5Qt9EMX.js";import{o as m,b as c,f as d,c as l,a as n,q as g,e as p,k as b,d as h,l as y}from"./main-DHtEt640.js";import"./layout-Bzk_Fs54.js";const f=["suaviagemaqui.adm@gmail.com"];let s=[];m(c,async t=>{const e=document.getElementById("page-loading");if(!t){window.location.href="pagina_login.html";return}!f.includes(t.email)&&t.email.includes("admin"),await w(),x(),document.getElementById("last-update").innerText=new Date().toLocaleTimeString(),e.classList.add("hidden")});window.switchTab=t=>{["dashboard","partners","settings"].forEach(e=>{document.getElementById(`view-${e}`).classList.add("hidden"),document.getElementById(`tab-${e}`).classList.remove("active")}),document.getElementById(`view-${t}`).classList.remove("hidden"),document.getElementById(`tab-${t}`).classList.add("active"),t==="partners"&&window.loadPartners()};async function w(){try{const t=await d(l(n,"users")),e=await d(l(n,"partners"));document.getElementById("stat-users").innerText=t.size||1240,document.getElementById("stat-partners").innerText=e.size||48}catch(t){console.log("Modo demo (sem permissão de leitura total): Usando dados mockados",t),document.getElementById("stat-users").innerText="1,240",document.getElementById("stat-partners").innerText="48"}}function x(){Chart.defaults.color="#94a3b8",Chart.defaults.borderColor="rgba(148, 163, 184, 0.1)";const t=document.getElementById("partnersChart").getContext("2d");new Chart(t,{type:"line",data:{labels:["Jan","Fev","Mar","Abr","Mai","Jun"],datasets:[{label:"Novos Parceiros",data:[5,9,12,19,25,32],borderColor:"#a78bfa",backgroundColor:"rgba(167, 139, 250, 0.1)",tension:.4,fill:!0}]},options:{responsive:!0,plugins:{legend:{display:!1}}}});const e=document.getElementById("categoriesChart").getContext("2d");new Chart(e,{type:"doughnut",data:{labels:["Hospedagem","Passeios","Gastronomia","Guias"],datasets:[{data:[35,40,15,10],backgroundColor:["#3b82f6","#10b981","#f59e0b","#8b5cf6"],borderWidth:0}]},options:{responsive:!0,cutout:"70%"}})}window.loadPartners=async()=>{const t=document.getElementById("partners-table-body"),e=document.getElementById("partners-loading");t.innerHTML="",e.classList.remove("hidden");try{const a=g(l(n,"partners"),p("createdAt","desc")),o=await d(a);s=[],o.forEach(i=>{s.push({id:i.id,...i.data()})}),s.length===0&&(s=[{id:"mock1",businessName:"Pousada Sol",plan:"plus",status:"aprovado",createdAt:new Date().toISOString()},{id:"mock2",businessName:"Restaurante Mar",plan:"basic",status:"pendente",createdAt:new Date().toISOString()}]),E()}catch(a){console.error(a)}finally{e.classList.add("hidden")}};function E(){const t=document.getElementById("partners-table-body");t.innerHTML=s.map(e=>`
        <tr class="hover:bg-slate-800/30 transition">
            <td class="p-4 font-medium text-white">${e.businessName}</td>
            <td class="p-4"><span class="uppercase text-xs font-bold px-2 py-1 rounded border border-slate-600 ${v(e.plan)}">${e.plan||"Free"}</span></td>
            <td class="p-4"><span class="flex items-center"><span class="w-2 h-2 rounded-full mr-2 ${e.status==="aprovado"?"bg-green-500":"bg-yellow-500"}"></span> ${e.status}</span></td>
            <td class="p-4 text-slate-400 text-sm">${new Date(e.createdAt).toLocaleDateString()}</td>
            <td class="p-4 text-right">
                <button onclick="toggleStatus('${e.id}', '${e.status}')" class="text-slate-400 hover:text-white transition mr-2" title="Alterar Status">
                    <i class="fas fa-power-off"></i>
                </button>
                <button class="text-slate-400 hover:text-blue-400 transition" title="Ver Detalhes">
                    <i class="fas fa-eye"></i>
                </button>
            </td>
        </tr>
    `).join("")}function v(t){return t==="advance"?"bg-purple-500/20 text-purple-400":t==="plus"?"bg-amber-500/20 text-amber-400":t==="basic"?"bg-blue-500/20 text-blue-400":"bg-slate-700 text-slate-300"}window.toggleStatus=async(t,e)=>{if(t.startsWith("mock")){r("Simulação: Status alterado!");return}const a=e==="aprovado"?"suspenso":"aprovado";try{await b(h(n,"partners",t),{status:a}),r(`Parceiro ${a}!`),window.loadPartners()}catch(o){console.error(o),r("Erro ao atualizar status.")}};function r(t){const e=document.getElementById("toast");document.getElementById("toast-msg").innerText=t,e.classList.remove("translate-y-20"),setTimeout(()=>e.classList.add("translate-y-20"),3e3)}const u=()=>y(c).then(()=>window.location.href="index.html");document.getElementById("logout-btn").onclick=u;document.getElementById("logout-btn-mobile").onclick=u;
